Subject: [PATCH] 适配DDD整改
---
Index: backend/domain/src/main/java/com/personal/portfolio/blog/domain/entity/BlogPost.java
===================================================================
diff --git a/backend/domain/src/main/java/com/personal/portfolio/blog/domain/entity/BlogPost.java b/backend/domain/src/main/java/com/personal/portfolio/blog/domain/entity/BlogPost.java
deleted file mode 100644
--- a/backend/domain/src/main/java/com/personal/portfolio/blog/domain/entity/BlogPost.java	(revision 0325aaa6a249f79a33f1469fc5f3324b6d54c2f8)
+++ /dev/null	(revision 0325aaa6a249f79a33f1469fc5f3324b6d54c2f8)
@@ -1,198 +0,0 @@
-package com.personal.portfolio.blog.domain.entity;
-
-import com.baomidou.mybatisplus.extension.handlers.JacksonTypeHandler;
-import lombok.Getter;
-import lombok.Setter;
-import com.baomidou.mybatisplus.annotation.*;
-
-import java.time.LocalDateTime;
-import java.util.List;
-
-/**
- * 博客文章实体类
- */
-@TableName("blog_posts")
-@Getter
-@Setter
-public class BlogPost {
-    
-    /**
-     * 文章ID，主键，自增
-     */
-    @TableId(type = IdType.AUTO)
-    private Long id;
-    
-    /**
-     * 文章标题，必填，最大长度200字符
-     */
-    private String title;
-    
-    /**
-     * 文章别名，用于URL，唯一，必填，最大长度200字符
-     */
-    private String slug;
-    
-    /**
-     * 文章内容，必填，TEXT类型
-     */
-    private String content;
-    
-    /**
-     * 文章摘要，可选，最大长度500字符
-     */
-    private String summary;
-    
-    /**
-     * 封面图片URL，可选，最大长度255字符
-     */
-    private String coverImage;
-    
-    /**
-     * 是否已发布，默认未发布
-     */
-    private Boolean isPublished = false;
-    
-    /**
-     * 浏览量，默认0
-     */
-    private Integer viewCount = 0;
-    
-    /**
-     * 点赞数，默认0
-     */
-    private Integer likeCount = 0;
-    
-    /**
-     * 评论数，默认0
-     */
-    private Integer commentCount = 0;
-    
-    /**
-     * 创建时间，必填
-     */
-    private LocalDateTime createdAt;
-    
-    /**
-     * 更新时间，必填
-     */
-    private LocalDateTime updatedAt;
-    
-    /**
-     * 发布时间，可选
-     */
-    private LocalDateTime publishedAt;
-    
-    /**
-     * 作者ID，必填
-     */
-    private Long authorId;
-    
-    /**
-     * 分类ID，可选
-     */
-    private Long categoryId;
-    
-    /**
-     * 分类名称，可选
-     */
-    private String category;
-    
-    /**
-     * 标签列表，可选
-     */
-    @TableField(typeHandler = JacksonTypeHandler.class)
-    private List<String> tags;
-    
-    public BlogPost() {
-        this.createdAt = LocalDateTime.now();
-        this.updatedAt = LocalDateTime.now();
-    }
-    
-    public BlogPost(String title, String slug, String content, Long authorId) {
-        this();
-        this.title = title;
-        this.slug = slug;
-        this.content = content;
-        this.authorId = authorId;
-    }
-    
-    /**
-     * 发布博客文章
-     */
-    public void publish() {
-        this.isPublished = true;
-        this.publishedAt = LocalDateTime.now();
-        this.updatedAt = LocalDateTime.now();
-    }
-    
-    /**
-     * 取消发布博客文章
-     */
-    public void unpublish() {
-        this.isPublished = false;
-        this.publishedAt = null;
-        this.updatedAt = LocalDateTime.now();
-    }
-    
-    /**
-     * 更新博客内容
-     */
-    public void updateContent(String title, String slug, String content, String summary, String coverImage, String category, List<String> tags) {
-        this.title = title;
-        this.slug = slug;
-        this.content = content;
-        this.summary = summary;
-        this.coverImage = coverImage;
-        this.category = category;
-        this.tags = tags;
-        this.updatedAt = LocalDateTime.now();
-    }
-    
-    /**
-     * 增加浏览量
-     */
-    public void incrementViewCount() {
-        this.viewCount++;
-    }
-    
-    /**
-     * 增加点赞数
-     */
-    public void incrementLikeCount() {
-        this.likeCount++;
-    }
-    
-    /**
-     * 减少点赞数
-     */
-    public void decrementLikeCount() {
-        if (this.likeCount > 0) {
-            this.likeCount--;
-        }
-    }
-    
-    /**
-     * 更新评论数
-     */
-    public void updateCommentCount(int count) {
-        this.commentCount = count;
-        this.updatedAt = LocalDateTime.now();
-    }
-    
-    /**
-     * 验证博客文章是否有效
-     */
-    public boolean isValid() {
-        return title != null && !title.trim().isEmpty() &&
-               slug != null && !slug.trim().isEmpty() &&
-               content != null && !content.trim().isEmpty() &&
-               authorId != null;
-    }
-    
-    /**
-     * 更新前自动设置更新时间
-     */
-    public void preUpdate() {
-        this.updatedAt = LocalDateTime.now();
-    }
-}
Index: backend/domain/src/main/java/com/personal/portfolio/blog/domain/entity/Category.java
===================================================================
diff --git a/backend/domain/src/main/java/com/personal/portfolio/blog/domain/entity/Category.java b/backend/domain/src/main/java/com/personal/portfolio/blog/domain/entity/Category.java
deleted file mode 100644
--- a/backend/domain/src/main/java/com/personal/portfolio/blog/domain/entity/Category.java	(revision 0325aaa6a249f79a33f1469fc5f3324b6d54c2f8)
+++ /dev/null	(revision 0325aaa6a249f79a33f1469fc5f3324b6d54c2f8)
@@ -1,111 +0,0 @@
-package com.personal.portfolio.blog.domain.entity;
-
-import lombok.Getter;
-import lombok.Setter;
-import com.baomidou.mybatisplus.annotation.*;
-
-import java.time.LocalDateTime;
-
-/**
- * 博客分类实体类
- */
-@TableName("categories")
-@Getter
-@Setter
-public class Category {
-    
-    /**
-     * 分类ID，主键，自增
-     */
-    @TableId(type = IdType.AUTO)
-    private Long id;
-    
-    /**
-     * 分类名称，必填，最大长度50字符
-     */
-    private String name;
-    
-    /**
-     * 分类别名，用于URL，唯一，必填，最大长度50字符
-     */
-    private String slug;
-    
-    /**
-     * 分类描述，可选，最大长度200字符
-     */
-    private String description;
-    
-    /**
-     * 分类颜色，可选，最大长度20字符
-     */
-    private String color;
-    
-    /**
-     * 排序权重，默认0
-     */
-    private Integer sortOrder = 0;
-    
-    /**
-     * 是否启用，默认启用
-     */
-    private Boolean isEnabled = true;
-    
-    /**
-     * 文章数量，默认0
-     */
-    private Integer postCount = 0;
-    
-    /**
-     * 创建时间，必填
-     */
-    private LocalDateTime createdAt;
-    
-    /**
-     * 更新时间，必填
-     */
-    private LocalDateTime updatedAt;
-    
-    public Category() {
-        this.createdAt = LocalDateTime.now();
-        this.updatedAt = LocalDateTime.now();
-    }
-    
-    public Category(String name, String slug) {
-        this();
-        this.name = name;
-        this.slug = slug;
-    }
-    
-    /**
-     * 验证分类是否有效
-     */
-    public boolean isValid() {
-        return name != null && !name.trim().isEmpty() &&
-               slug != null && !slug.trim().isEmpty();
-    }
-    
-    /**
-     * 增加文章数量
-     */
-    public void incrementPostCount() {
-        this.postCount++;
-        this.updatedAt = LocalDateTime.now();
-    }
-    
-    /**
-     * 减少文章数量
-     */
-    public void decrementPostCount() {
-        if (this.postCount > 0) {
-            this.postCount--;
-            this.updatedAt = LocalDateTime.now();
-        }
-    }
-    
-    /**
-     * 更新前自动设置更新时间
-     */
-    public void preUpdate() {
-        this.updatedAt = LocalDateTime.now();
-    }
-}
Index: backend/domain/src/main/java/com/personal/portfolio/blog/domain/entity/Comment.java
===================================================================
diff --git a/backend/domain/src/main/java/com/personal/portfolio/blog/domain/entity/Comment.java b/backend/domain/src/main/java/com/personal/portfolio/blog/domain/entity/Comment.java
deleted file mode 100644
--- a/backend/domain/src/main/java/com/personal/portfolio/blog/domain/entity/Comment.java	(revision 0325aaa6a249f79a33f1469fc5f3324b6d54c2f8)
+++ /dev/null	(revision 0325aaa6a249f79a33f1469fc5f3324b6d54c2f8)
@@ -1,116 +0,0 @@
-package com.personal.portfolio.blog.domain.entity;
-
-import lombok.Getter;
-import lombok.Setter;
-import com.baomidou.mybatisplus.annotation.*;
-
-import java.time.LocalDateTime;
-
-/**
- * 评论实体类
- */
-@TableName("comments")
-@Getter
-@Setter
-public class Comment {
-    
-    /**
-     * 评论ID，主键，自增
-     */
-    @TableId(type = IdType.AUTO)
-    private Long id;
-    
-    /**
-     * 评论内容，必填，最大长度1000字符
-     */
-    private String content;
-    
-    /**
-     * 评论者名称，必填，最大长度50字符
-     */
-    private String authorName;
-    
-    /**
-     * 评论者邮箱，可选，最大长度100字符
-     */
-    private String authorEmail;
-    
-    /**
-     * 评论者网站，可选，最大长度255字符
-     */
-    private String authorWebsite;
-    
-    /**
-     * 是否已审核，默认未审核
-     */
-    private Boolean isApproved = false;
-    
-    /**
-     * 创建时间，必填
-     */
-    private LocalDateTime createdAt;
-    
-    /**
-     * 更新时间，必填
-     */
-    private LocalDateTime updatedAt;
-    
-    /**
-     * 博客文章ID，必填
-     */
-    private Long blogPostId;
-    
-    /**
-     * 父评论ID，可选（用于回复评论）
-     */
-    private Long parentId;
-    
-    /**
-     * 用户ID，可选（如果评论者是注册用户）
-     */
-    private Long userId;
-    
-    public Comment() {
-        this.createdAt = LocalDateTime.now();
-        this.updatedAt = LocalDateTime.now();
-    }
-    
-    public Comment(String content, String authorName, Long blogPostId) {
-        this();
-        this.content = content;
-        this.authorName = authorName;
-        this.blogPostId = blogPostId;
-    }
-    
-    /**
-     * 审核评论
-     */
-    public void approve() {
-        this.isApproved = true;
-        this.updatedAt = LocalDateTime.now();
-    }
-    
-    /**
-     * 取消审核评论
-     */
-    public void unapprove() {
-        this.isApproved = false;
-        this.updatedAt = LocalDateTime.now();
-    }
-    
-    /**
-     * 验证评论是否有效
-     */
-    public boolean isValid() {
-        return content != null && !content.trim().isEmpty() &&
-               authorName != null && !authorName.trim().isEmpty() &&
-               blogPostId != null;
-    }
-    
-    /**
-     * 更新前自动设置更新时间
-     */
-    public void preUpdate() {
-        this.updatedAt = LocalDateTime.now();
-    }
-}
Index: backend/domain/src/main/java/com/personal/portfolio/blog/domain/entity/User.java
===================================================================
diff --git a/backend/domain/src/main/java/com/personal/portfolio/blog/domain/entity/User.java b/backend/domain/src/main/java/com/personal/portfolio/blog/domain/entity/User.java
deleted file mode 100644
--- a/backend/domain/src/main/java/com/personal/portfolio/blog/domain/entity/User.java	(revision 0325aaa6a249f79a33f1469fc5f3324b6d54c2f8)
+++ /dev/null	(revision 0325aaa6a249f79a33f1469fc5f3324b6d54c2f8)
@@ -1,126 +0,0 @@
-package com.personal.portfolio.blog.domain.entity;
-
-import lombok.Getter;
-import lombok.Setter;
-import com.baomidou.mybatisplus.annotation.*;
-
-import java.time.LocalDateTime;
-
-/**
- * 用户实体类
- */
-@TableName("users")
-@Getter
-@Setter
-public class User {
-    
-    /**
-     * 用户ID，主键，自增
-     */
-    @TableId(type = IdType.AUTO)
-    private Long id;
-    
-    /**
-     * GitHub用户ID
-     */
-    private String githubId;
-    
-    /**
-     * 用户名，必填，最大长度50字符
-     */
-    private String username;
-    
-    /**
-     * 邮箱地址，可选，最大长度100字符
-     */
-    private String email;
-    
-    /**
-     * 显示名称，可选，最大长度100字符
-     */
-    private String displayName;
-    
-    /**
-     * 头像URL，可选，最大长度255字符
-     */
-    private String avatarUrl;
-    
-    /**
-     * 个人简介，可选，最大长度500字符
-     */
-    private String bio;
-    
-    /**
-     * 位置信息，可选，最大长度100字符
-     */
-    private String location;
-    
-    /**
-     * 公司信息，可选，最大长度100字符
-     */
-    private String company;
-    
-    /**
-     * 个人网站，可选，最大长度255字符
-     */
-    private String website;
-    
-    /**
-     * Twitter用户名，可选，最大长度50字符
-     */
-    private String twitterUsername;
-    
-    /**
-     * 公开仓库数量
-     */
-    private Integer publicRepos = 0;
-    
-    /**
-     * 粉丝数量
-     */
-    private Integer followers = 0;
-    
-    /**
-     * 关注数量
-     */
-    private Integer following = 0;
-
-    /**
-     * 密码，用于本地账户登录
-     */
-    private String password;
-
-    /**
-     * 是否为本地注册账户
-     */
-    private Boolean isLocalAccount = false;
-
-    /**
-     * 创建时间，必填
-     */
-    private LocalDateTime createdAt;
-
-    /**
-     * 更新时间，必填
-     */
-    private LocalDateTime updatedAt;
-    
-    public User() {
-        this.createdAt = LocalDateTime.now();
-        this.updatedAt = LocalDateTime.now();
-    }
-    
-    public User(String githubId, String username, String email) {
-        this();
-        this.githubId = githubId;
-        this.username = username;
-        this.email = email;
-    }
-    
-    /**
-     * 更新前自动设置更新时间
-     */
-    public void preUpdate() {
-        this.updatedAt = LocalDateTime.now();
-    }
-}
Index: backend/infrastructure/src/main/java/com/personal/portfolio/blog/infrastructure/common/response/ResultData.java
===================================================================
diff --git a/backend/infrastructure/src/main/java/com/personal/portfolio/blog/infrastructure/common/response/ResultData.java b/backend/infrastructure/src/main/java/com/personal/portfolio/blog/infrastructure/common/response/ResultData.java
deleted file mode 100644
--- a/backend/infrastructure/src/main/java/com/personal/portfolio/blog/infrastructure/common/response/ResultData.java	(revision 0325aaa6a249f79a33f1469fc5f3324b6d54c2f8)
+++ /dev/null	(revision 0325aaa6a249f79a33f1469fc5f3324b6d54c2f8)
@@ -1,35 +0,0 @@
-package com.personal.portfolio.blog.infrastructure.common.response;
-
-import lombok.Data;
-
-@Data
-public class ResultData<T> {
-    /** 结果状态 ,具体状态码参见ResultData.java*/
-    private int status;
-    private String message;
-    private T data;
-    private long timestamp ;
-
-
-    public ResultData (){
-        this.timestamp = System.currentTimeMillis();
-    }
-
-
-    public static <T> ResultData<T> success(T data) {
-        ResultData<T> resultData = new ResultData<>();
-        resultData.setStatus(ReturnCode.RC100.getCode());
-        resultData.setMessage(ReturnCode.RC100.getMessage());
-        resultData.setData(data);
-        return resultData;
-    }
-
-    public static <T> ResultData<T> fail(int code, String message) {
-        ResultData<T> resultData = new ResultData<>();
-        resultData.setStatus(code);
-        resultData.setMessage(message);
-        return resultData;
-    }
-
-}
-
Index: backend/infrastructure/src/main/java/com/personal/portfolio/blog/infrastructure/common/response/ReturnCode.java
===================================================================
diff --git a/backend/infrastructure/src/main/java/com/personal/portfolio/blog/infrastructure/common/response/ReturnCode.java b/backend/infrastructure/src/main/java/com/personal/portfolio/blog/infrastructure/common/response/ReturnCode.java
deleted file mode 100644
--- a/backend/infrastructure/src/main/java/com/personal/portfolio/blog/infrastructure/common/response/ReturnCode.java	(revision 0325aaa6a249f79a33f1469fc5f3324b6d54c2f8)
+++ /dev/null	(revision 0325aaa6a249f79a33f1469fc5f3324b6d54c2f8)
@@ -1,52 +0,0 @@
-package com.personal.portfolio.blog.infrastructure.common.response;
-
-public enum ReturnCode {
-    /**操作成功**/
-    RC100(100,"操作成功"),
-    /**操作失败**/
-    RC999(999,"操作失败"),
-    /**服务限流**/
-    RC200(200,"服务开启限流保护,请稍后再试!"),
-    /**服务降级**/
-    RC201(201,"服务开启降级保护,请稍后再试!"),
-    /**热点参数限流**/
-    RC202(202,"热点参数限流,请稍后再试!"),
-    /**系统规则不满足**/
-    RC203(203,"系统规则不满足要求,请稍后再试!"),
-    /**授权规则不通过**/
-    RC204(204,"授权规则不通过,请稍后再试!"),
-    /**access_denied**/
-    RC403(403,"无访问权限,请联系管理员授予权限"),
-    /**access_denied**/
-    RC401(401,"匿名用户访问无权限资源时的异常"),
-    /**服务异常**/
-    RC500(500,"系统异常，请稍后重试"),
-
-    INVALID_TOKEN(2001,"访问令牌不合法"),
-    ACCESS_DENIED(2003,"没有权限访问该资源"),
-    CLIENT_AUTHENTICATION_FAILED(1001,"客户端认证失败"),
-    USERNAME_OR_PASSWORD_ERROR(1002,"用户名或密码错误"),
-    UNSUPPORTED_GRANT_TYPE(1003, "不支持的认证模式");
-
-
-
-    /**自定义状态码**/
-    private final int code;
-    /**自定义描述**/
-    private final String message;
-
-    ReturnCode(int code, String message){
-        this.code = code;
-        this.message = message;
-    }
-
-
-    public int getCode() {
-        return code;
-    }
-
-    public String getMessage() {
-        return message;
-    }
-}
-
Index: COMPILATION_FIXES.md
===================================================================
diff --git a/COMPILATION_FIXES.md b/COMPILATION_FIXES.md
deleted file mode 100644
--- a/COMPILATION_FIXES.md	(revision 0325aaa6a249f79a33f1469fc5f3324b6d54c2f8)
+++ /dev/null	(revision 0325aaa6a249f79a33f1469fc5f3324b6d54c2f8)
@@ -1,80 +0,0 @@
-# 编译错误修复文档
-
-## 修复的问题
-
-### 1. ID类型不匹配问题
-**问题**: BlogPost实体类的ID类型从UUID改为Long，但Repository、Service和Controller层仍然使用UUID类型。
-
-**修复内容**:
-- `BlogPostRepository.java`: 将所有UUID参数改为Long
-- `BlogPostRepositoryImpl.java`: 
-  - 将ConcurrentHashMap的键类型从UUID改为Long
-  - 更新所有方法参数类型
-  - 添加ID生成逻辑（使用时间戳作为临时方案）
-- `BlogPostService.java`: 将所有UUID参数改为Long
-- `BlogPostController.java`: 将所有@PathVariable UUID改为Long
-
-### 2. 方法引用问题
-**问题**: `BlogPost::isPublished`方法引用无效，因为BlogPost类中不存在isPublished()方法。
-
-**修复内容**:
-- `BlogPostRepositoryImpl.java`: 将`BlogPost::isPublished`改为`post -> post.getIsPublished()`
-
-### 3. 构造函数参数不匹配
-**问题**: BlogPost构造函数参数已更改，但Service层仍然使用旧的构造函数。
-
-**修复内容**:
-- `BlogPostService.java`: 更新createBlogPost方法，添加slug参数，将author参数类型从String改为User
-- `BlogPostController.java`: 更新请求DTO，添加slug、summary、coverImage字段
-
-### 4. 实体关系更新
-**问题**: BlogPost的author字段现在引用User实体对象，而不是简单的字符串。
-
-**修复内容**:
-- `BlogPostService.java`: 更新createBlogPost方法，接受User对象作为参数
-- `BlogPostController.java`: 更新CreateBlogPostRequest，将author字段类型改为User
-
-## 技术细节
-
-### ID生成策略
-- **原方案**: UUID.randomUUID()
-- **新方案**: 使用数据库自增ID (GenerationType.IDENTITY)
-- **临时方案**: 在内存存储中使用System.currentTimeMillis()作为ID
-
-### 字段变更
-BlogPost实体类的主要变更：
-- `id`: UUID → Long
-- `author`: String → User (对象引用)
-- `published`: boolean → `isPublished`: Boolean
-- 新增字段: `slug`, `summary`, `coverImage`, `viewCount`, `likeCount`, `commentCount`, `publishedAt`
-
-### 关系映射
-- 用户 ↔ 文章: 一对多关系
-- 用户 ↔ 评论: 一对多关系  
-- 分类 ↔ 文章: 一对多关系
-- 文章 ↔ 评论: 一对多关系
-- 评论 ↔ 评论: 自关联关系
-
-## 验证状态
-
-✅ **Repository层**: 已修复ID类型和方法引用问题
-✅ **Service层**: 已修复ID类型和构造函数调用问题  
-✅ **Controller层**: 已修复ID类型和请求DTO问题
-✅ **实体类**: 所有4个实体类已创建并配置JPA注解
-✅ **数据库配置**: H2内存数据库已正确配置
-
-## 下一步建议
-
-1. **创建其他实体的Repository**: 为User、Category、Comment创建对应的Repository接口和实现
-2. **创建其他实体的Service**: 为User、Category、Comment创建对应的Service类
-3. **创建其他实体的Controller**: 为User、Category、Comment创建对应的Controller类
-4. **配置Spring Data JPA**: 考虑使用Spring Data JPA简化Repository实现
-5. **添加数据初始化**: 创建测试数据用于开发测试
-6. **完善用户认证**: 实现用户登录和权限控制
-
-## 注意事项
-
-- 当前的内存存储实现是临时的，实际项目中应该使用数据库
-- 用户认证逻辑需要进一步完善
-- 需要添加数据验证和异常处理
-- 考虑添加分页和排序功能
Index: backend/infrastructure/src/main/java/com/personal/portfolio/blog/infrastructure/exception/ProfileException.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/backend/infrastructure/src/main/java/com/personal/portfolio/blog/infrastructure/exception/ProfileException.java b/backend/infrastructure/src/main/java/com/personal/portfolio/blog/infrastructure/exception/ProfileException.java
new file mode 100644
--- /dev/null	(date 1764899527170)
+++ b/backend/infrastructure/src/main/java/com/personal/portfolio/blog/infrastructure/exception/ProfileException.java	(date 1764899527170)
@@ -0,0 +1,11 @@
+package com.personal.portfolio.blog.infrastructure.exception;
+
+public class ProfileException extends RuntimeException {
+    public ProfileException(String message) {
+        super(message);
+    }
+
+    public ProfileException(String message, Throwable cause) {
+        super(message, cause);
+    }
+}
Index: backend/infrastructure/src/main/java/com/personal/portfolio/blog/infrastructure/util/ProfileUtil.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/backend/infrastructure/src/main/java/com/personal/portfolio/blog/infrastructure/util/ProfileUtil.java b/backend/infrastructure/src/main/java/com/personal/portfolio/blog/infrastructure/util/ProfileUtil.java
--- a/backend/infrastructure/src/main/java/com/personal/portfolio/blog/infrastructure/util/ProfileUtil.java	(revision 0325aaa6a249f79a33f1469fc5f3324b6d54c2f8)
+++ b/backend/infrastructure/src/main/java/com/personal/portfolio/blog/infrastructure/util/ProfileUtil.java	(date 1764899723106)
@@ -3,6 +3,7 @@
 import static com.personal.portfolio.blog.infrastructure.context.ContextConstants.*;
 
 import com.alibaba.ttl.TransmittableThreadLocal;
+import com.personal.portfolio.blog.infrastructure.exception.ProfileException;
 
 import java.util.HashMap;
 import java.util.Map;
@@ -35,14 +36,20 @@
         return getProfiles().get(key);
     }
 
-    public static String getUsername() {
-        String userId = get(USERNAME);
-        return userId == null ? NULL_USER : userId;
+    public static String getUsername() throws ProfileException {
+        String username = get(USERNAME);
+        if (username == null) {
+            throw new ProfileException("username is null");
+        }
+        return username;
     }
 
-    public static String getUserId() {
+    public static Long getUserId() {
         String userId = get(USER_ID);
-        return userId == null ? NULL_USER_ID : userId;
+        if (userId == null) {
+            throw new ProfileException("userId is null");
+        }
+        return Long.parseLong(userId);
     }
 
     public static String getHost() {
Index: backend/application/pom.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/backend/application/pom.xml b/backend/application/pom.xml
--- a/backend/application/pom.xml	(revision 0325aaa6a249f79a33f1469fc5f3324b6d54c2f8)
+++ b/backend/application/pom.xml	(date 1764904150440)
@@ -24,21 +24,6 @@
             <version>${project.version}</version>
         </dependency>
         <dependency>
-            <groupId>com.personal.portfolio</groupId>
-            <artifactId>infrastructure</artifactId>
-            <version>${project.version}</version>
-            <exclusions>
-                <exclusion>
-                    <groupId>org.springframework.boot</groupId>
-                    <artifactId>spring-boot-starter-data-jpa</artifactId>
-                </exclusion>
-                <exclusion>
-                    <groupId>com.h2database</groupId>
-                    <artifactId>h2</artifactId>
-                </exclusion>
-            </exclusions>
-        </dependency>
-        <dependency>
             <groupId>org.projectlombok</groupId>
             <artifactId>lombok</artifactId>
         </dependency>
Index: backend/infrastructure/src/main/java/com/personal/portfolio/blog/infrastructure/web/advice/ResponseAdvice.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/backend/infrastructure/src/main/java/com/personal/portfolio/blog/infrastructure/web/advice/ResponseAdvice.java b/backend/infrastructure/src/main/java/com/personal/portfolio/blog/infrastructure/web/advice/ResponseAdvice.java
--- a/backend/infrastructure/src/main/java/com/personal/portfolio/blog/infrastructure/web/advice/ResponseAdvice.java	(revision 0325aaa6a249f79a33f1469fc5f3324b6d54c2f8)
+++ b/backend/infrastructure/src/main/java/com/personal/portfolio/blog/infrastructure/web/advice/ResponseAdvice.java	(date 1764904534025)
@@ -1,7 +1,7 @@
 package com.personal.portfolio.blog.infrastructure.web.advice;
 
 import com.fasterxml.jackson.databind.ObjectMapper;
-import com.personal.portfolio.blog.infrastructure.common.response.ResultData;
+import com.personal.portfolio.blog.domain.common.ApiResponse;
 import lombok.SneakyThrows;
 import org.springframework.beans.factory.annotation.Autowired;
 import org.springframework.core.MethodParameter;
@@ -25,18 +25,18 @@
     @SneakyThrows
     @Override
     public Object beforeBodyWrite(Object o, MethodParameter methodParameter, MediaType mediaType, Class<? extends HttpMessageConverter<?>> aClass, ServerHttpRequest serverHttpRequest, ServerHttpResponse serverHttpResponse) {
-        // 如果已经是ResultData，则不进行封装
-        if (o instanceof ResultData) {
+        // 如果已经是ApiResponse，则不进行封装
+        if (o instanceof ApiResponse) {
             return o;
         }
         
         // 如果返回类型是String，需要特殊处理
         if (o instanceof String) {
-            return objectMapper.writeValueAsString(ResultData.success(o));
+            return objectMapper.writeValueAsString(ApiResponse.success(o));
         }
         
-        // 对于其他类型，统一封装为ResultData
-        return ResultData.success(o);
+        // 对于其他类型，统一封装为ApiResponse
+        return ApiResponse.success(o);
     }
 
 
Index: backend/infrastructure/src/main/java/com/personal/portfolio/blog/infrastructure/persistence/mapper/UserMapper.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/backend/infrastructure/src/main/java/com/personal/portfolio/blog/infrastructure/persistence/mapper/UserMapper.java b/backend/infrastructure/src/main/java/com/personal/portfolio/blog/infrastructure/persistence/mapper/UserMapper.java
--- a/backend/infrastructure/src/main/java/com/personal/portfolio/blog/infrastructure/persistence/mapper/UserMapper.java	(revision 0325aaa6a249f79a33f1469fc5f3324b6d54c2f8)
+++ b/backend/infrastructure/src/main/java/com/personal/portfolio/blog/infrastructure/persistence/mapper/UserMapper.java	(date 1764995093952)
@@ -1,7 +1,7 @@
 package com.personal.portfolio.blog.infrastructure.persistence.mapper;
 
 import com.baomidou.mybatisplus.core.mapper.BaseMapper;
-import com.personal.portfolio.blog.domain.entity.User;
+import com.personal.portfolio.blog.domain.model.User;
 import org.apache.ibatis.annotations.Mapper;
 import org.apache.ibatis.annotations.Param;
 import org.apache.ibatis.annotations.Select;
Index: backend/domain/src/main/java/com/personal/portfolio/blog/domain/repository/UserRepository.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/backend/domain/src/main/java/com/personal/portfolio/blog/domain/repository/UserRepository.java b/backend/domain/src/main/java/com/personal/portfolio/blog/domain/repository/UserRepository.java
--- a/backend/domain/src/main/java/com/personal/portfolio/blog/domain/repository/UserRepository.java	(revision 0325aaa6a249f79a33f1469fc5f3324b6d54c2f8)
+++ b/backend/domain/src/main/java/com/personal/portfolio/blog/domain/repository/UserRepository.java	(date 1764917372019)
@@ -1,6 +1,6 @@
 package com.personal.portfolio.blog.domain.repository;
 
-import com.personal.portfolio.blog.domain.entity.User;
+import com.personal.portfolio.blog.domain.model.User;
 
 import java.util.List;
 import java.util.Optional;
Index: DDD和代码简洁架构规范.md
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/DDD和代码简洁架构规范.md b/DDD和代码简洁架构规范.md
new file mode 100644
--- /dev/null	(date 1764901636900)
+++ b/DDD和代码简洁架构规范.md	(date 1764901636900)
@@ -0,0 +1,467 @@
+# DDD + 代码简洁之道项目代码规范
+
+## 一、架构分层规范
+
+### 1.1 分层架构（四层架构）
+```
+┌─────────────────────────────────────┐
+│           用户界面层                 │
+│           (User Interface Layer)     │
+├─────────────────────────────────────┤
+│           应用服务层                 │
+│       (Application Service Layer)    │
+├─────────────────────────────────────┤
+│           领域层                     │
+│           (Domain Layer)             │
+├─────────────────────────────────────┤
+│           基础设施层                 │
+│      (Infrastructure Layer)          │
+└─────────────────────────────────────┘
+```
+
+### 1.2 依赖关系规则（严格单向依赖）
+- 用户界面层 → 应用服务层 → 领域层 ← 基础设施层
+- **禁止**：应用服务层依赖基础设施层（通过依赖倒置）
+- **禁止**：领域层依赖外层任何组件
+- **允许**：基础设施层实现领域层的接口
+
+### 1.3 各层职责
+```java
+// 领域层 - 核心业务逻辑
+domain/
+├── model/              # 聚合根、实体、值对象
+├── service/           # 领域服务
+├── repository/        # 仓储接口
+├── event/            # 领域事件
+└── factory/          # 工厂
+
+// 应用层 - 协调领域对象完成用例
+application/
+├── service/          # 应用服务
+├── dto/              # 数据传输对象
+├── command/          # 命令对象
+├── query/            # 查询对象
+└── event/            # 应用事件
+
+// 基础设施层 - 技术实现
+infrastructure/
+├── persistence/      # 持久化实现
+├── external/         # 外部服务调用
+├── message/          # 消息队列
+└── config/           # 配置
+
+// 用户界面层
+interfaces/
+├── web/              # Web控制器
+├── rpc/              # RPC接口
+├── graphql/          # GraphQL
+└── dto/              # 请求/响应对象
+```
+
+## 二、代码简洁规范
+
+### 2.1 类规范
+- **最大行数**：单个类不超过 **300行**（理想状态200行）
+- **单一职责**：每个类只做一件事
+- **命名规范**：
+    - 实体类：名词，如 `User`, `BlogPost`
+    - 领域服务：`XXXDomainService`，如 `BlogPostDomainService`
+    - 应用服务：`XXXAppService`，如 `BlogPostAppService`
+    - 仓储接口：`XXXRepository`，如 `BlogPostRepository`
+    - 工厂：`XXXFactory`，如 `BlogPostFactory`
+
+### 2.2 方法规范
+- **最大行数**：单个方法不超过 **30行**
+- **参数数量**：不超过 **4个**（强制）
+- **圈复杂度**：不超过 **10**
+- **抽象级别一致**：方法内所有语句在同一抽象级别
+
+### 2.3 函数设计原则
+```java
+// ❌ 不好的示例 - 方法太长，参数太多
+public void processOrder(Long orderId, Long userId, String address, 
+                         List<OrderItem> items, boolean useCoupon, 
+                         String paymentMethod, String remark) {
+    // 超过20行逻辑...
+}
+
+// ✅ 好的示例 - 使用命令对象封装参数
+public void processOrder(CreateOrderCommand command) {
+    validateCommand(command);          // 3行
+    Order order = createOrder(command); // 5行  
+    saveOrder(order);                   // 2行
+    publishEvent(order);                // 3行
+    // 总计13行
+}
+```
+
+### 2.4 异常处理规范
+- **受检异常**：仅在基础设施层使用
+- **领域异常**：继承 `RuntimeException`
+- **异常消息**：明确说明原因和解决方案
+- **不要吞异常**：禁止空的catch块
+
+## 三、DDD核心元素规范
+
+### 3.1 实体（Entity）
+```java
+// ✅ 正确的实体设计
+public class Order extends BaseEntity<OrderId> {
+    private OrderStatus status;
+    private Money totalAmount;
+    private Address shippingAddress;
+    private List<OrderItem> items;
+    
+    // 1. 保护不变式
+    public void addItem(OrderItem item) {
+        if (status != OrderStatus.CREATED) {
+            throw new IllegalOrderStateException("只能向新建订单添加商品");
+        }
+        this.items.add(item);
+        this.totalAmount = calculateTotal();
+    }
+    
+    // 2. 业务方法不超过15行
+    public void pay(Payment payment) {
+        validatePayment(payment);      // 3行
+        applyPayment(payment);         // 5行
+        changeStatus(OrderStatus.PAID); // 2行
+        recordPayment(payment);         // 3行
+        // 总计13行
+    }
+    
+    // 3. 使用值对象封装基本类型
+    public void changeAddress(Address newAddress) {
+        this.shippingAddress = newAddress;
+    }
+}
+```
+
+### 3.2 值对象（Value Object）
+```java
+// ✅ 不可变的值对象
+public class Address implements ValueObject {
+    private final String province;
+    private final String city;
+    private final String detail;
+    
+    // 1. 所有属性通过构造函数设置
+    public Address(String province, String city, String detail) {
+        this.province = Objects.requireNonNull(province);
+        this.city = Objects.requireNonNull(city);
+        this.detail = Objects.requireNonNull(detail);
+    }
+    
+    // 2. 实现equals和hashCode
+    @Override
+    public boolean equals(Object o) {
+        if (this == o) return true;
+        if (!(o instanceof Address)) return false;
+        Address address = (Address) o;
+        return province.equals(address.province) &&
+               city.equals(address.city) &&
+               detail.equals(address.detail);
+    }
+}
+```
+
+### 3.3 聚合根（Aggregate Root）
+```java
+// ✅ 聚合根示例
+public class Order extends BaseAggregateRoot<OrderId> {
+    // 1. 保护内部状态
+    private List<OrderItem> items = new ArrayList<>();
+    
+    // 2. 控制边界访问
+    public List<OrderItem> getItems() {
+        return Collections.unmodifiableList(items);
+    }
+    
+    // 3. 发布领域事件
+    public void cancel() {
+        this.status = OrderStatus.CANCELLED;
+        registerEvent(new OrderCancelledEvent(this.id));
+    }
+    
+    // 4. 工厂方法创建复杂对象
+    public static Order create(CreateOrderCommand command, User user) {
+        Order order = new Order();
+        order.id = OrderId.generate();
+        order.userId = user.getId();
+        order.status = OrderStatus.CREATED;
+        return order;
+    }
+}
+```
+
+### 3.4 领域服务（Domain Service）
+```java
+// ✅ 领域服务 - 无状态服务
+@Service
+@Slf4j
+public class OrderPaymentService {
+    
+    // 1. 方法参数不超过4个
+    public PaymentResult processPayment(Order order, PaymentMethod method, Money amount) {
+        // 2. 方法体不超过20行
+        validatePayment(order, method, amount);  // 4行
+        Payment payment = createPayment(order, method, amount);  // 5行
+        PaymentResult result = executePayment(payment);  // 6行
+        updateOrderPayment(order, result);  // 3行
+        return result;  // 1行
+        // 总计19行
+    }
+    
+    // 3. 私有辅助方法不超过10行
+    private Payment createPayment(Order order, PaymentMethod method, Money amount) {
+        return Payment.builder()
+                .orderId(order.getId())
+                .method(method)
+                .amount(amount)
+                .build();
+    }
+}
+```
+
+### 3.5 应用服务（Application Service）
+```java
+// ✅ 应用服务 - 协调者角色
+@Service
+@Transactional
+@Slf4j
+@RequiredArgsConstructor
+public class OrderAppService {
+    private final OrderRepository orderRepository;
+    private final OrderPaymentService paymentService;
+    private final EventPublisher eventPublisher;
+    
+    // 1. 使用命令对象减少参数
+    public OrderResult createOrder(CreateOrderCommand command) {
+        // 2. 每行一个操作，清晰明了
+        validateCommand(command);                     // 验证输入
+        Order order = buildOrder(command);            // 构建领域对象
+        orderRepository.save(order);                  // 持久化
+        eventPublisher.publish(new OrderCreatedEvent(order.getId()));  // 发布事件
+        return OrderResult.success(order.getId());    // 返回结果
+        // 总计6行逻辑
+    }
+    
+    // 3. 一个方法一个用例
+    @Transactional
+    public void cancelOrder(CancelOrderCommand command) {
+        Order order = findOrder(command.getOrderId());
+        order.cancel(command.getReason());  // 委托给领域对象
+        orderRepository.save(order);
+    }
+}
+```
+
+## 四、代码质量硬性指标
+
+### 4.1 静态代码分析规则
+```yaml
+# SonarQube/SonarLint配置
+rules:
+  # 方法复杂度
+  - rule: "Method complexity should not exceed 10"
+    metric: "CyclomaticComplexity"
+    threshold: 10
+    
+  - rule: "Method length should not exceed 20 lines"
+    metric: "MethodLength"
+    threshold: 20
+    
+  - rule: "Class length should not exceed 300 lines"
+    metric: "ClassLength"
+    threshold: 300
+    
+  - rule: "Parameters count should not exceed 4"
+    metric: "ParameterCount"
+    threshold: 4
+    
+  # 依赖规则
+  - rule: "Domain layer should not depend on outer layers"
+    from: "**/domain/**"
+    to: ["**/application/**", "**/infrastructure/**", "**/interfaces/**"]
+    severity: "BLOCKER"
+```
+
+### 4.2 测试规范
+```java
+// ✅ 测试类规范
+class OrderServiceTest {
+    
+    // 1. 每个测试方法不超过15行
+    @Test
+    void should_create_order_successfully() {
+        // Given - 3行
+        CreateOrderCommand command = buildValidCommand();
+        
+        // When - 1行
+        OrderResult result = orderService.createOrder(command);
+        
+        // Then - 3行
+        assertThat(result.isSuccess()).isTrue();
+        assertThat(result.getOrderId()).isNotNull();
+        // 总计7行
+    }
+    
+    // 2. 测试方法名明确表达场景和预期
+    @Test
+    void should_throw_exception_when_order_items_empty() {
+        // BDD风格：Given-When-Then
+    }
+}
+```
+
+### 4.3 包结构规范
+```
+src/main/java/com/example/
+├── domain/                          # 领域层
+│   ├── model/                      # 领域模型
+│   │   ├── order/                  # 订单聚合
+│   │   │   ├── Order.java          # 聚合根 <300行
+│   │   │   ├── OrderItem.java      # 实体 <200行
+│   │   │   ├── OrderId.java        # 值对象 <100行
+│   │   │   ├── Address.java        # 值对象 <100行
+│   │   │   └── OrderStatus.java    # 枚举
+│   │   └── user/                   # 用户聚合
+│   ├── service/                    # 领域服务
+│   │   ├── OrderService.java       # <300行，每个方法<20行
+│   │   └── PaymentService.java
+│   ├── repository/                 # 仓储接口
+│   │   ├── OrderRepository.java
+│   │   └── UserRepository.java
+│   ├── event/                      # 领域事件
+│   │   └── OrderCreatedEvent.java
+│   └── factory/                    # 工厂
+│       └── OrderFactory.java
+├── application/                     # 应用层
+│   ├── service/                    # 应用服务
+│   │   ├── OrderAppService.java    # <300行
+│   │   └── UserAppService.java
+│   ├── dto/                        # DTO
+│   │   ├── CreateOrderCommand.java # 命令对象
+│   │   └── OrderResult.java        # 返回结果
+│   └── event/                      # 应用事件
+├── infrastructure/                  # 基础设施层
+│   ├── persistence/                # 持久化实现
+│   │   ├── OrderRepositoryImpl.java
+│   │   └── mapper/                 # 数据映射
+│   ├── external/                   # 外部服务
+│   │   └── PaymentClient.java
+│   └── config/                     # 配置
+└── interfaces/                      # 用户界面层
+    ├── web/                        # Web接口
+    │   ├── OrderController.java    # <200行，每个方法<15行
+    │   └── dto/                    # 请求响应DTO
+    └── rpc/                        # RPC接口
+```
+
+## 五、代码审查检查清单
+
+### 5.1 强制性规则（一票否决）
+- [ ] 领域层是否依赖了外层组件？
+- [ ] 类是否超过300行？
+- [ ] 方法是否超过20行？
+- [ ] 方法参数是否超过4个？
+- [ ] 圈复杂度是否超过10？
+- [ ] 是否有空catch块？
+- [ ] 是否在领域层使用了基础设施术语？
+
+### 5.2 建议性规则
+- [ ] 方法是否单一职责？
+- [ ] 命名是否准确表达意图？
+- [ ] 是否使用了基本类型而不是值对象？
+- [ ] 是否过度使用getter/setter暴露内部状态？
+- [ ] 是否每个测试用例只验证一个行为？
+
+### 5.3 架构规则
+- [ ] 聚合根是否控制了自己的边界？
+- [ ] 实体是否保护了自己的不变式？
+- [ ] 应用服务是否只做协调工作？
+- [ ] 领域服务是否无状态？
+- [ ] 仓储接口是否在领域层定义？
+
+## 六、开发工作流规则
+
+### 6.1 Git提交规范
+```
+feat(domain): 添加订单取消功能
+- Order实体添加cancel()方法（15行）
+- OrderService添加验证逻辑（12行）
+- 添加订单取消事件
+- 方法参数控制在3个以内
+- 类行数未超过250行
+```
+
+### 6.2 重构时机
+当出现以下情况时立即重构：
+1. 方法超过30行时
+2. 参数超过4个时
+3. 发现重复代码时
+4. 类职责不清晰时
+
+### 6.3 代码生成规则
+```
+请遵循DDD+代码简洁规范：
+1. 类不超过300行，方法不超过30行
+2. 方法参数不超过4个，优先使用值对象封装
+3. 领域层不依赖外层组件
+4. 使用聚合根保护不变式
+5. 应用服务只做协调，业务逻辑在领域层
+6. 优先使用不可变值对象
+7. 每个方法单一职责，抽象级别一致
+```
+
+## 七、示例模板
+
+### 7.1 命令对象模板
+```java
+// 行数：<50行
+@Data
+@Builder
+@NoArgsConstructor
+@AllArgsConstructor
+public class CreateOrderCommand implements Command {
+    @NotNull
+    private Long userId;
+    
+    @NotEmpty
+    private List<OrderItemCommand> items;  // 使用值对象列表
+    
+    @Valid
+    private AddressCommand address;        // 嵌套值对象
+    
+    private String couponCode;
+    
+    // 验证方法 <10行
+    public void validate() {
+        if (items.isEmpty()) {
+            throw new ValidationException("订单商品不能为空");
+        }
+    }
+}
+```
+
+### 7.2 实体方法模板
+```java
+// 业务方法模板 <15行
+public void changeStatus(OrderStatus newStatus, String reason) {
+    // 1. 验证前置条件（3-5行）
+    validateTransition(this.status, newStatus);
+    
+    // 2. 修改状态（1行）
+    this.status = newStatus;
+    this.statusReason = reason;
+    
+    // 3. 记录变更（2-3行）
+    this.updatedAt = LocalDateTime.now();
+    
+    // 4. 发布事件（2-3行）
+    if (newStatus == OrderStatus.CANCELLED) {
+        registerEvent(new OrderCancelledEvent(this.id, reason));
+    }
+    // 总计<15行
+}
+```
Index: backend/infrastructure/src/main/java/com/personal/portfolio/blog/infrastructure/persistence/BlogPostRepositoryImpl.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/backend/infrastructure/src/main/java/com/personal/portfolio/blog/infrastructure/persistence/BlogPostRepositoryImpl.java b/backend/infrastructure/src/main/java/com/personal/portfolio/blog/infrastructure/persistence/BlogPostRepositoryImpl.java
--- a/backend/infrastructure/src/main/java/com/personal/portfolio/blog/infrastructure/persistence/BlogPostRepositoryImpl.java	(revision 0325aaa6a249f79a33f1469fc5f3324b6d54c2f8)
+++ b/backend/infrastructure/src/main/java/com/personal/portfolio/blog/infrastructure/persistence/BlogPostRepositoryImpl.java	(date 1764917185427)
@@ -1,9 +1,11 @@
 package com.personal.portfolio.blog.infrastructure.persistence;
 
 import com.baomidou.mybatisplus.core.conditions.query.LambdaQueryWrapper;
-import com.personal.portfolio.blog.domain.entity.BlogPost;
+import com.personal.portfolio.blog.domain.model.BlogPost;
+import com.personal.portfolio.blog.domain.event.BlogPostCreatedEvent;
 import com.personal.portfolio.blog.domain.repository.BlogPostRepository;
 import com.personal.portfolio.blog.infrastructure.persistence.mapper.BlogPostMapper;
+import org.springframework.context.ApplicationEventPublisher;
 import org.springframework.stereotype.Repository;
 
 import java.util.List;
@@ -16,28 +18,64 @@
 public class BlogPostRepositoryImpl implements BlogPostRepository {
     
     private final BlogPostMapper blogPostMapper;
+    private final ApplicationEventPublisher applicationEventPublisher;
     
-    public BlogPostRepositoryImpl(BlogPostMapper blogPostMapper) {
+    public BlogPostRepositoryImpl(BlogPostMapper blogPostMapper, ApplicationEventPublisher applicationEventPublisher) {
         this.blogPostMapper = blogPostMapper;
+        this.applicationEventPublisher = applicationEventPublisher;
     }
     
     @Override
     public BlogPost save(BlogPost blogPost) {
-        if (blogPost.getId() == null) {
-            // 新增
-            blogPost.preUpdate();
+        boolean isNew = blogPost.getId() == null;
+        
+        // 确保在保存前调用preUpdate同步值对象
+        blogPost.preUpdate();
+        
+        if (isNew) {
+            // 新增
             blogPostMapper.insert(blogPost);
         } else {
             // 更新
-            blogPost.preUpdate();
             blogPostMapper.updateById(blogPost);
         }
+        
+        // 发布领域事件
+        publishDomainEvents(blogPost, isNew);
+        
         return blogPost;
     }
     
+    /**
+     * 发布领域事件
+     */
+    private void publishDomainEvents(BlogPost blogPost, boolean isNew) {
+        List<Object> domainEvents = blogPost.getAndClearDomainEvents();
+        
+        for (Object event : domainEvents) {
+            // 如果是BlogPostCreatedEvent且是新增操作，需要设置ID
+            if (event instanceof BlogPostCreatedEvent createdEvent && isNew) {
+                // 创建新的事件对象，设置正确的ID
+                BlogPostCreatedEvent updatedEvent = new BlogPostCreatedEvent(
+                    blogPost.getId(),
+                    createdEvent.title(),
+                    createdEvent.authorId(),
+                    createdEvent.createdAt()
+                );
+                applicationEventPublisher.publishEvent(updatedEvent);
+            } else {
+                applicationEventPublisher.publishEvent(event);
+            }
+        }
+    }
+    
     @Override
     public Optional<BlogPost> findById(Long id) {
         BlogPost blogPost = blogPostMapper.selectById(id);
+        if (blogPost != null) {
+            // 加载后初始化值对象
+            blogPost.postLoad();
+        }
         return Optional.ofNullable(blogPost);
     }
     
@@ -45,12 +83,18 @@
     public List<BlogPost> findAll() {
         LambdaQueryWrapper<BlogPost> queryWrapper = new LambdaQueryWrapper<>();
         queryWrapper.orderByDesc(BlogPost::getCreatedAt);
-        return blogPostMapper.selectList(queryWrapper);
+        List<BlogPost> blogPosts = blogPostMapper.selectList(queryWrapper);
+        // 初始化值对象
+        blogPosts.forEach(BlogPost::postLoad);
+        return blogPosts;
     }
     
     @Override
     public List<BlogPost> findPublishedPosts() {
-        return blogPostMapper.selectPublishedPosts();
+        List<BlogPost> blogPosts = blogPostMapper.selectPublishedPosts();
+        // 初始化值对象
+        blogPosts.forEach(BlogPost::postLoad);
+        return blogPosts;
     }
     
     @Override
Index: backend/application/src/main/java/com/personal/portfolio/blog/application/service/UserRegistrationService.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/backend/application/src/main/java/com/personal/portfolio/blog/application/service/UserRegistrationService.java b/backend/application/src/main/java/com/personal/portfolio/blog/application/service/UserRegistrationService.java
--- a/backend/application/src/main/java/com/personal/portfolio/blog/application/service/UserRegistrationService.java	(revision 0325aaa6a249f79a33f1469fc5f3324b6d54c2f8)
+++ b/backend/application/src/main/java/com/personal/portfolio/blog/application/service/UserRegistrationService.java	(date 1764917475353)
@@ -1,6 +1,6 @@
 package com.personal.portfolio.blog.application.service;
 
-import com.personal.portfolio.blog.domain.entity.User;
+import com.personal.portfolio.blog.domain.model.User;
 import com.personal.portfolio.blog.domain.repository.UserRepository;
 import com.personal.portfolio.blog.application.util.PasswordUtil;
 import lombok.RequiredArgsConstructor;
@@ -45,13 +45,8 @@
             }
         }
         
-        // 创建新用户
-        User user = new User();
-        user.setUsername(username);
-        user.setPassword(PasswordUtil.encodePassword(password));
-        user.setEmail(email);
-        user.setIsLocalAccount(true);
-        user.setDisplayName(username); // 默认显示名与用户名相同
+        // 创建新用户 - 使用User实体的工厂方法
+        User user = User.createLocalUser(username, email, PasswordUtil.encodePassword(password));
         
         return userRepository.save(user);
     }
@@ -76,8 +71,8 @@
             return null;
         }
         
-        // 验证密码
-        if (user.getPassword() == null || !PasswordUtil.matches(password, user.getPassword())) {
+        // 验证密码 - 使用User实体的验证方法
+        if (!user.validatePassword(password)) {
             return null;
         }
         
Index: backend/infrastructure/src/main/java/com/personal/portfolio/blog/infrastructure/persistence/UserRepositoryImpl.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/backend/infrastructure/src/main/java/com/personal/portfolio/blog/infrastructure/persistence/UserRepositoryImpl.java b/backend/infrastructure/src/main/java/com/personal/portfolio/blog/infrastructure/persistence/UserRepositoryImpl.java
--- a/backend/infrastructure/src/main/java/com/personal/portfolio/blog/infrastructure/persistence/UserRepositoryImpl.java	(revision 0325aaa6a249f79a33f1469fc5f3324b6d54c2f8)
+++ b/backend/infrastructure/src/main/java/com/personal/portfolio/blog/infrastructure/persistence/UserRepositoryImpl.java	(date 1764995075172)
@@ -1,7 +1,7 @@
 package com.personal.portfolio.blog.infrastructure.persistence;
 
 import com.baomidou.mybatisplus.core.conditions.query.LambdaQueryWrapper;
-import com.personal.portfolio.blog.domain.entity.User;
+import com.personal.portfolio.blog.domain.model.User;
 import com.personal.portfolio.blog.domain.repository.UserRepository;
 import com.personal.portfolio.blog.infrastructure.persistence.mapper.UserMapper;
 import org.springframework.stereotype.Repository;
Index: backend/domain/src/main/java/com/personal/portfolio/blog/domain/repository/BlogPostRepository.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/backend/domain/src/main/java/com/personal/portfolio/blog/domain/repository/BlogPostRepository.java b/backend/domain/src/main/java/com/personal/portfolio/blog/domain/repository/BlogPostRepository.java
--- a/backend/domain/src/main/java/com/personal/portfolio/blog/domain/repository/BlogPostRepository.java	(revision 0325aaa6a249f79a33f1469fc5f3324b6d54c2f8)
+++ b/backend/domain/src/main/java/com/personal/portfolio/blog/domain/repository/BlogPostRepository.java	(date 1764917088897)
@@ -1,6 +1,6 @@
 package com.personal.portfolio.blog.domain.repository;
 
-import com.personal.portfolio.blog.domain.entity.BlogPost;
+import com.personal.portfolio.blog.domain.model.BlogPost;
 
 import java.util.List;
 import java.util.Optional;
Index: DD充血模型架构规范.md
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/DD充血模型架构规范.md b/DD充血模型架构规范.md
new file mode 100644
--- /dev/null	(date 1764910213585)
+++ b/DD充血模型架构规范.md	(date 1764910213585)
@@ -0,0 +1,618 @@
+# DDD 充血模型规范补充
+
+## 一、充血模型核心理念
+
+### 1.1 基本原则
+- **数据+行为一体**：实体不仅是数据容器，更是业务行为的载体
+- **封装业务规则**：业务规则内聚在实体内部，而不是散落在服务中
+- **保护不变式**：实体始终保证自身状态的有效性
+- **最小化贫血**：避免只有getter/setter的"哑巴对象"
+
+## 二、充血模型实现规范
+
+### 2.1 实体设计规范
+
+```java
+// ✅ 正确的充血实体示例
+public class Order extends BaseAggregateRoot<OrderId> {
+    private OrderStatus status;
+    private Money totalAmount;
+    private Address shippingAddress;
+    private List<OrderItem> items = new ArrayList<>();
+    private PaymentInfo paymentInfo;
+    
+    // ============ 构造方法 ============
+    // 1. 保护性构造：确保创建时就是有效的
+    protected Order() {
+        // JPA等框架需要
+    }
+    
+    // 2. 工厂方法：封装创建逻辑
+    public static Order create(Long userId, List<OrderItem> items, Address address) {
+        Order order = new Order();
+        order.id = OrderId.generate();
+        order.userId = userId;
+        order.status = OrderStatus.CREATED;
+        order.createdAt = LocalDateTime.now();
+        
+        // 通过业务方法添加商品，而不是直接设置
+        items.forEach(order::addItem);
+        order.changeAddress(address);
+        
+        return order;
+    }
+    
+    // ============ 业务方法 ============
+    // 3. 每个业务方法不超过30行
+    public void addItem(Product product, int quantity) {
+        // 验证业务规则（3-5行）
+        validateCanAddItem();
+        validateProduct(product);
+        validateQuantity(quantity);
+        
+        // 执行业务操作（5-8行）
+        OrderItem item = OrderItem.create(product, quantity, this);
+        items.add(item);
+        recalculateTotalAmount();
+        
+        // 发布领域事件（2-3行）
+        if (shouldNotifyInventory(items.size())) {
+            registerEvent(new OrderItemAddedEvent(this.id, product.getId(), quantity));
+        }
+        // 总计<30行
+    }
+    
+    public void cancel(String reason) {
+        // 保护不变式：只有特定状态可以取消
+        if (!status.canCancel()) {
+            throw new OrderStateException("当前状态不可取消订单");
+        }
+        
+        this.status = OrderStatus.CANCELLED;
+        this.cancelReason = reason;
+        this.cancelledAt = LocalDateTime.now();
+        
+        // 级联取消子项
+        items.forEach(item -> item.cancel());
+        
+        registerEvent(new OrderCancelledEvent(this.id, reason));
+    }
+    
+    public void pay(Payment payment) {
+        // 验证支付
+        validatePayment(payment);
+        
+        // 执行支付
+        this.paymentInfo = PaymentInfo.from(payment);
+        this.status = OrderStatus.PAID;
+        this.paidAt = LocalDateTime.now();
+        
+        // 计算折扣等业务逻辑
+        applyDiscountIfEligible();
+        
+        registerEvent(new OrderPaidEvent(this.id, payment.getAmount()));
+    }
+    
+    public void ship(String trackingNumber) {
+        // 验证状态
+        if (status != OrderStatus.PAID) {
+            throw new OrderStateException("只有已支付的订单可以发货");
+        }
+        
+        // 更新状态
+        this.status = OrderStatus.SHIPPED;
+        this.trackingNumber = trackingNumber;
+        this.shippedAt = LocalDateTime.now();
+        
+        // 生成发货单
+        ShippingNote note = generateShippingNote();
+        this.shippingNote = note;
+        
+        registerEvent(new OrderShippedEvent(this.id, trackingNumber));
+    }
+    
+    // ============ 计算属性 ============
+    // 4. 将计算逻辑内聚在实体中
+    public Money calculateTotalWithTax() {
+        Money subtotal = calculateSubtotal();
+        Money tax = calculateTax(subtotal);
+        return subtotal.add(tax);
+    }
+    
+    public boolean isOverdue() {
+        if (status != OrderStatus.SHIPPED) {
+            return false;
+        }
+        return shippedAt.plusDays(30).isBefore(LocalDateTime.now());
+    }
+    
+    public int getItemCount() {
+        return items.stream()
+                   .mapToInt(OrderItem::getQuantity)
+                   .sum();
+    }
+    
+    // ============ 验证方法 ============
+    // 5. 验证逻辑内聚
+    private void validateCanAddItem() {
+        if (status != OrderStatus.CREATED) {
+            throw new OrderStateException("订单已确认，无法添加商品");
+        }
+        if (items.size() >= MAX_ITEMS) {
+            throw new BusinessRuleException("订单商品数量超过限制");
+        }
+    }
+    
+    private void validatePayment(Payment payment) {
+        if (payment.getAmount().isLessThan(totalAmount)) {
+            throw new PaymentException("支付金额不足");
+        }
+        if (payment.getCurrency() != totalAmount.getCurrency()) {
+            throw new PaymentException("货币类型不匹配");
+        }
+    }
+    
+    // ============ 内部方法 ============
+    // 6. 私有方法实现细节
+    private void recalculateTotalAmount() {
+        this.totalAmount = items.stream()
+                               .map(OrderItem::getSubtotal)
+                               .reduce(Money.ZERO, Money::add);
+    }
+    
+    private void applyDiscountIfEligible() {
+        if (isEligibleForDiscount()) {
+            Discount discount = calculateDiscount();
+            this.totalAmount = totalAmount.subtract(discount.getAmount());
+            this.appliedDiscount = discount;
+        }
+    }
+    
+    private boolean isEligibleForDiscount() {
+        return totalAmount.isGreaterThan(Money.of(100))
+                && isFirstOrderOfMonth();
+    }
+}
+```
+
+### 2.2 值对象的充血设计
+
+```java
+// ✅ 充血的值对象
+public class Money implements ValueObject, Comparable<Money> {
+    private final BigDecimal amount;
+    private final Currency currency;
+    
+    // 业务方法丰富
+    public Money add(Money other) {
+        validateSameCurrency(other);
+        return new Money(amount.add(other.amount), currency);
+    }
+    
+    public Money subtract(Money other) {
+        validateSameCurrency(other);
+        return new Money(amount.subtract(other.amount), currency);
+    }
+    
+    public Money multiply(BigDecimal multiplier) {
+        return new Money(amount.multiply(multiplier), currency);
+    }
+    
+    public Money divide(BigDecimal divisor) {
+        return new Money(amount.divide(divisor, RoundingMode.HALF_EVEN), currency);
+    }
+    
+    // 业务判断方法
+    public boolean isZero() {
+        return amount.compareTo(BigDecimal.ZERO) == 0;
+    }
+    
+    public boolean isPositive() {
+        return amount.compareTo(BigDecimal.ZERO) > 0;
+    }
+    
+    public boolean isNegative() {
+        return amount.compareTo(BigDecimal.ZERO) < 0;
+    }
+    
+    public boolean isGreaterThan(Money other) {
+        validateSameCurrency(other);
+        return amount.compareTo(other.amount) > 0;
+    }
+    
+    public boolean isLessThan(Money other) {
+        validateSameCurrency(other);
+        return amount.compareTo(other.amount) < 0;
+    }
+    
+    // 工厂方法
+    public static Money zero(Currency currency) {
+        return new Money(BigDecimal.ZERO, currency);
+    }
+    
+    public static Money of(long amount, Currency currency) {
+        return new Money(BigDecimal.valueOf(amount), currency);
+    }
+    
+    // 格式化输出
+    public String format() {
+        return NumberFormat.getCurrencyInstance(currency.getLocale())
+                          .format(amount);
+    }
+}
+```
+
+### 2.3 聚合根的边界控制
+
+```java
+public class Order extends BaseAggregateRoot<OrderId> {
+    // 1. 内部集合使用不可变视图暴露
+    private List<OrderItem> items = new ArrayList<>();
+    
+    public List<OrderItem> getItems() {
+        return Collections.unmodifiableList(items);
+    }
+    
+    // 2. 通过业务方法修改集合
+    public void addItem(OrderItem item) {
+        // 业务验证...
+        items.add(item);
+        recalculateTotal();
+    }
+    
+    public void removeItem(ProductId productId) {
+        // 业务验证...
+        items.removeIf(item -> item.getProductId().equals(productId));
+        recalculateTotal();
+    }
+    
+    // 3. 聚合内实体的业务方法
+    public void updateItemQuantity(ProductId productId, int newQuantity) {
+        OrderItem item = findItem(productId);
+        item.updateQuantity(newQuantity);  // OrderItem也有自己的业务逻辑
+        recalculateTotal();
+    }
+    
+    private OrderItem findItem(ProductId productId) {
+        return items.stream()
+                   .filter(item -> item.getProductId().equals(productId))
+                   .findFirst()
+                   .orElseThrow(() -> new ItemNotFoundException(productId));
+    }
+}
+```
+
+### 2.4 内部实体的充血设计
+
+```java
+// ✅ 内部实体的充血设计
+public class OrderItem extends BaseEntity<Long> {
+    private ProductId productId;
+    private String productName;
+    private Money unitPrice;
+    private int quantity;
+    private Money subtotal;
+    
+    // 业务方法
+    public void updateQuantity(int newQuantity) {
+        if (newQuantity <= 0) {
+            throw new IllegalArgumentException("数量必须大于0");
+        }
+        if (newQuantity > MAX_QUANTITY_PER_ITEM) {
+            throw new BusinessRuleException("单商品数量超过限制");
+        }
+        
+        this.quantity = newQuantity;
+        recalculateSubtotal();
+    }
+    
+    public void applyDiscount(Discount discount) {
+        if (!discount.isApplicableTo(this)) {
+            throw new DiscountException("折扣不适用于此商品");
+        }
+        
+        this.unitPrice = discount.applyTo(unitPrice);
+        recalculateSubtotal();
+    }
+    
+    public boolean isSameProduct(ProductId otherProductId) {
+        return this.productId.equals(otherProductId);
+    }
+    
+    // 计算属性
+    private void recalculateSubtotal() {
+        this.subtotal = unitPrice.multiply(BigDecimal.valueOf(quantity));
+    }
+    
+    public Money getSubtotal() {
+        return subtotal;
+    }
+}
+```
+
+## 三、充血模型检查清单
+
+### 3.1 必须有的特征（强制）
+- [ ] **业务方法丰富**：实体至少有3个以上的业务方法
+- [ ] **验证内聚**：业务规则验证在实体内部完成
+- [ ] **不变式保护**：任何状态修改都经过验证
+- [ ] **无公开setter**：避免 `setStatus()`，使用 `cancel()`、`complete()` 等方法
+- [ ] **领域事件发布**：重要状态变更发布领域事件
+
+### 3.2 推荐有的特征
+- [ ] **工厂方法**：提供语义化的创建方式
+- [ ] **计算属性**：将计算逻辑内聚
+- [ ] **查询方法**：提供业务意义的查询方法（如 `isOverdue()`）
+- [ ] **级联操作**：聚合根控制内部实体的状态变更
+- [ ] **快照方法**：提供 `toSnapshot()` 用于持久化或传输
+
+### 3.3 禁止的特征
+- [ ] **贫血模型**：只有getter/setter，没有业务方法
+- [ ] **上帝方法**：一个方法做多件事情（超过20行）
+- [ ] **泄露实现**：暴露内部数据结构（如返回 `ArrayList` 而不是 `List`）
+- [ ] **外部验证**：在实体外部验证业务规则
+- [ ] **原始偏执**：过度使用基本类型而不是值对象
+
+## 四、充血模型与分层协作
+
+### 4.1 应用服务调用充血模型
+```java
+@Service
+@Transactional
+@RequiredArgsConstructor
+public class OrderAppService {
+    private final OrderRepository orderRepository;
+    
+    // ✅ 正确的调用方式：委托给实体
+    public void cancelOrder(CancelOrderCommand command) {
+        Order order = orderRepository.findById(command.getOrderId())
+                                    .orElseThrow(() -> new OrderNotFoundException());
+        
+        // 调用实体的业务方法，而不是自己实现逻辑
+        order.cancel(command.getReason(), command.getCancelledBy());
+        
+        orderRepository.save(order);
+        // 总计<10行
+    }
+    
+    // ❌ 错误的做法：在应用服务实现业务逻辑
+    public void cancelOrderWrong(CancelOrderCommand command) {
+        Order order = orderRepository.findById(command.getOrderId())
+                                    .orElseThrow(() -> new OrderNotFoundException());
+        
+        // 贫血模型的典型错误：在外部验证和修改状态
+        if (!order.getStatus().canCancel()) {
+            throw new IllegalStateException();
+        }
+        order.setStatus(OrderStatus.CANCELLED);  // 直接setter
+        order.setCancelReason(command.getReason());
+        order.setUpdatedAt(LocalDateTime.now());
+        // ... 更多散落的业务逻辑
+    }
+}
+```
+
+### 4.2 工厂的充血使用
+```java
+@Component
+public class OrderFactory {
+    
+    // ✅ 复杂的创建逻辑封装在工厂中
+    public Order createFromCart(ShoppingCart cart, User user, Discount discount) {
+        Order order = Order.create(user.getId());
+        
+        // 转换购物车项为订单项
+        cart.getItems().forEach(cartItem -> {
+            OrderItem orderItem = createOrderItem(cartItem);
+            order.addItem(orderItem);
+        });
+        
+        // 应用折扣
+        if (discount != null && discount.isApplicableTo(order)) {
+            order.applyDiscount(discount);
+        }
+        
+        // 设置配送地址
+        order.changeAddress(user.getDefaultAddress());
+        
+        return order;
+    }
+    
+    private OrderItem createOrderItem(CartItem cartItem) {
+        return OrderItem.builder()
+                       .productId(cartItem.getProductId())
+                       .productName(cartItem.getProductName())
+                       .unitPrice(cartItem.getPrice())
+                       .quantity(cartItem.getQuantity())
+                       .build();
+    }
+}
+```
+
+## 五、测试充血模型
+
+### 5.1 单元测试规范
+```java
+class OrderTest {
+    
+    @Test
+    void should_add_item_to_order_successfully() {
+        // Given
+        Order order = Order.create(userId);
+        Product product = createProduct();
+        
+        // When
+        order.addItem(product, 2);
+        
+        // Then
+        assertThat(order.getItemCount()).isEqualTo(2);
+        assertThat(order.getItems()).hasSize(1);
+        assertThat(order.getTotalAmount()).isEqualTo(product.getPrice().multiply(2));
+    }
+    
+    @Test
+    void should_throw_exception_when_adding_item_to_paid_order() {
+        // Given
+        Order order = Order.create(userId);
+        order.pay(createPayment());  // 改变状态
+        
+        // When & Then
+        assertThatThrownBy(() -> order.addItem(createProduct(), 1))
+                .isInstanceOf(OrderStateException.class)
+                .hasMessage("订单已确认，无法添加商品");
+    }
+    
+    @Test
+    void should_calculate_total_with_tax_correctly() {
+        // Given
+        Order order = Order.create(userId);
+        order.addItem(createProduct(price: Money.of(100)), 2);
+        
+        // When
+        Money totalWithTax = order.calculateTotalWithTax();
+        
+        // Then
+        assertThat(totalWithTax).isEqualTo(Money.of(236));  // 200 + 18%税
+    }
+}
+```
+
+## 六、充血模型重构指南
+
+### 6.1 从贫血模型重构为充血模型
+
+```java
+// ❌ 重构前：贫血模型
+public class Order {
+    // 只有数据字段
+    private Long id;
+    private String status;
+    private BigDecimal totalAmount;
+    private List<OrderItem> items;
+    
+    // 只有getter/setter
+    public Long getId() { return id; }
+    public void setId(Long id) { this.id = id; }
+    public String getStatus() { return status; }
+    public void setStatus(String status) { this.status = status; }
+    // ... 更多getter/setter
+}
+
+// ✅ 重构步骤1：添加业务方法
+public class Order {
+    // 步骤1：将setter改为业务方法
+    public void cancel(String reason) {
+        if (!"CREATED".equals(status) && !"PAID".equals(status)) {
+            throw new IllegalStateException("无法取消");
+        }
+        this.status = "CANCELLED";
+        this.cancelReason = reason;
+    }
+    
+    // 步骤2：添加更多的业务方法
+    public void addItem(Product product, int quantity) {
+        // 业务逻辑...
+    }
+    
+    // 步骤3：用值对象替换基本类型
+    private OrderStatus status;  // 枚举值对象
+    private Money totalAmount;   // 值对象
+    
+    // 步骤4：保护内部状态
+    public List<OrderItem> getItems() {
+        return Collections.unmodifiableList(items);
+    }
+}
+
+// ✅ 重构完成：完全的充血模型
+public class Order extends BaseAggregateRoot<OrderId> {
+    private OrderStatus status;
+    private Money totalAmount;
+    private List<OrderItem> items = new ArrayList<>();
+    
+    // 丰富的业务方法
+    public void cancel(String reason) { /* ... */ }
+    public void addItem(Product product, int quantity) { /* ... */ }
+    public void removeItem(ProductId productId) { /* ... */ }
+    public void pay(Payment payment) { /* ... */ }
+    public void ship(String trackingNumber) { /* ... */ }
+    public boolean isOverdue() { /* ... */ }
+    public Money calculateTotalWithTax() { /* ... */ }
+    
+    // 工厂方法
+    public static Order create(Long userId, Address address) { /* ... */ }
+}
+```
+
+### 6.2 充血模型代码生成提示词
+```
+请生成充血模型的DDD实体代码，要求：
+
+1. 数据+行为一体：实体包含丰富的业务方法
+2. 每个业务方法不超过30行代码
+3. 方法参数不超过4个
+4. 保护不变式：所有状态变更都经过验证
+5. 使用值对象替换基本类型
+6. 提供工厂方法创建实例
+7. 发布领域事件
+8. 暴露不可变视图的内部集合
+9. 包含业务计算属性（如isOverdue()）
+10. 无公开setter方法，只有有业务意义的修改方法
+```
+
+## 七、充血模型度量指标
+
+### 7.1 质量指标
+| 指标 | 目标值 | 说明 |
+|------|--------|------|
+| 业务方法/属性比 | ≥ 1.5 | 每个属性对应1.5个业务方法 |
+| setter方法数 | 0 | 充血模型不应有公开setter |
+| 业务方法平均行数 | ≤ 15 | 保持方法简洁 |
+| 验证方法内聚度 | 100% | 所有业务验证都在实体内部 |
+| 不变式保护覆盖率 | 100% | 所有状态变更都保护不变式 |
+
+### 7.2 代码示例模板
+```java
+// 充血实体模板
+public class {EntityName} extends BaseAggregateRoot<{EntityId}> {
+    // 1. 状态字段（使用值对象）
+    private {ValueObject} field1;
+    private List<{ChildEntity}> children = new ArrayList<>();
+    
+    // 2. 工厂方法
+    public static {EntityName} create({Params}) {
+        {EntityName} entity = new {EntityName}();
+        // 初始化逻辑...
+        return entity;
+    }
+    
+    // 3. 业务方法（每个<30行）
+    public void {businessAction}({Params}) {
+        // 验证（3-5行）
+        validate{BusinessAction}({Params});
+        
+        // 执行（5-8行）
+        execute{BusinessAction}({Params});
+        
+        // 发布事件（2-3行）
+        publish{BusinessAction}Event({Params});
+    }
+    
+    // 4. 查询方法
+    public boolean is{SomeCondition}() {
+        // 业务判断逻辑
+    }
+    
+    // 5. 保护内部状态
+    public List<{ChildEntity}> getChildren() {
+        return Collections.unmodifiableList(children);
+    }
+    
+    // 6. 私有验证方法
+    private void validate{BusinessAction}({Params}) {
+        // 验证逻辑
+    }
+}
+```
+
+充血模型是DDD实现的核心，通过将数据和行为紧密结合，使领域模型真正成为业务逻辑的承载者，而不是简单的数据容器。
Index: backend/infrastructure/src/main/java/com/personal/portfolio/blog/infrastructure/persistence/mapper/BlogPostMapper.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/backend/infrastructure/src/main/java/com/personal/portfolio/blog/infrastructure/persistence/mapper/BlogPostMapper.java b/backend/infrastructure/src/main/java/com/personal/portfolio/blog/infrastructure/persistence/mapper/BlogPostMapper.java
--- a/backend/infrastructure/src/main/java/com/personal/portfolio/blog/infrastructure/persistence/mapper/BlogPostMapper.java	(revision 0325aaa6a249f79a33f1469fc5f3324b6d54c2f8)
+++ b/backend/infrastructure/src/main/java/com/personal/portfolio/blog/infrastructure/persistence/mapper/BlogPostMapper.java	(date 1764917211206)
@@ -1,7 +1,7 @@
 package com.personal.portfolio.blog.infrastructure.persistence.mapper;
 
 import com.baomidou.mybatisplus.core.mapper.BaseMapper;
-import com.personal.portfolio.blog.domain.entity.BlogPost;
+import com.personal.portfolio.blog.domain.model.BlogPost;
 import org.apache.ibatis.annotations.Mapper;
 import org.apache.ibatis.annotations.Select;
 
Index: backend/application/src/main/java/com/personal/portfolio/blog/application/service/BlogPostService.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/backend/application/src/main/java/com/personal/portfolio/blog/application/service/BlogPostService.java b/backend/application/src/main/java/com/personal/portfolio/blog/application/service/BlogPostAppService.java
rename from backend/application/src/main/java/com/personal/portfolio/blog/application/service/BlogPostService.java
rename to backend/application/src/main/java/com/personal/portfolio/blog/application/service/BlogPostAppService.java
--- a/backend/application/src/main/java/com/personal/portfolio/blog/application/service/BlogPostService.java	(revision 0325aaa6a249f79a33f1469fc5f3324b6d54c2f8)
+++ b/backend/application/src/main/java/com/personal/portfolio/blog/application/service/BlogPostAppService.java	(date 1764917056359)
@@ -1,9 +1,14 @@
 package com.personal.portfolio.blog.application.service;
 
-import com.personal.portfolio.blog.domain.entity.BlogPost;
-import com.personal.portfolio.blog.domain.entity.User;
+import com.personal.portfolio.blog.application.dto.CreateBlogPostCommand;
+import com.personal.portfolio.blog.application.event.BlogPostCreatedApplicationEvent;
+import com.personal.portfolio.blog.domain.model.BlogPost;
+import com.personal.portfolio.blog.domain.model.valueobject.Title;
+import com.personal.portfolio.blog.domain.model.valueobject.Slug;
+import com.personal.portfolio.blog.domain.model.valueobject.Content;
 import com.personal.portfolio.blog.domain.repository.BlogPostRepository;
 import lombok.RequiredArgsConstructor;
+import org.springframework.context.ApplicationEventPublisher;
 import org.springframework.stereotype.Service;
 
 import java.util.List;
@@ -13,27 +18,72 @@
  */
 @Service
 @RequiredArgsConstructor
-public class BlogPostService {
+public class BlogPostAppService {
     
     private final BlogPostRepository blogPostRepository;
+    private final ApplicationEventPublisher applicationEventPublisher;
     
     /**
-     * 创建博客文章
+     * 创建博客文章（使用命令对象）
      */
-    public BlogPost createBlogPost(String title, String slug, String content, Long authorId) {
-        // 检查标题是否已存在
-        if (blogPostRepository.existsByTitle(title)) {
-            throw new IllegalArgumentException("博客标题已存在: " + title);
+    public BlogPost createBlogPost(CreateBlogPostCommand command) {
+        // 验证命令对象
+        if (!command.isValid()) {
+            throw new IllegalArgumentException(command.getValidationError());
+        }
+        
+        // 使用值对象创建博客文章
+        Title title = Title.of(command.getTitle());
+        Slug slug = Slug.of(command.getSlug());
+        Content content = Content.of(command.getContent());
+        
+        // 检查标题是否已存在（使用值对象）
+        if (blogPostRepository.existsByTitle(title.getValue())) {
+            throw new IllegalArgumentException("博客标题已存在: " + command.getTitle());
         }
         
-        BlogPost blogPost = new BlogPost(title, slug, content, authorId);
+        // 使用工厂方法创建博客文章
+        BlogPost blogPost = BlogPost.create(title, slug, content, command.getAuthorId());
+        
+        // 设置可选字段
+        if (command.getSummary() != null) {
+            blogPost.setSummary(command.getSummary());
+        }
+        if (command.getCoverImage() != null) {
+            blogPost.setCoverImage(command.getCoverImage());
+        }
+        if (command.getCategory() != null) {
+            blogPost.setCategory(command.getCategory());
+        }
+        if (command.getTags() != null) {
+            command.getTags().forEach(blogPost::addTag);
+        }
         
         // 验证博客文章是否有效
         if (!blogPost.isValid()) {
             throw new IllegalArgumentException("博客文章内容无效");
         }
         
-        return blogPostRepository.save(blogPost);
+        // 保存博客文章
+        BlogPost savedBlogPost = blogPostRepository.save(blogPost);
+        
+        // 发布博客创建应用事件
+        publishBlogPostCreatedEvent(savedBlogPost);
+        
+        return savedBlogPost;
+    }
+    
+    /**
+     * 发布博客创建应用事件
+     */
+    private void publishBlogPostCreatedEvent(BlogPost blogPost) {
+        BlogPostCreatedApplicationEvent event = new BlogPostCreatedApplicationEvent(
+            blogPost.getId(),
+            blogPost.getTitleValue(),
+            blogPost.getAuthorId(),
+            blogPost.getCreatedAt()
+        );
+        applicationEventPublisher.publishEvent(event);
     }
     
     /**
@@ -77,10 +127,11 @@
                 .orElseThrow(() -> new IllegalArgumentException("博客文章不存在: " + id));
         
         // 检查新标题是否与其他文章冲突
-        if (!blogPost.getTitle().equals(title) && blogPostRepository.existsByTitle(title)) {
+        if (!blogPost.getTitleValue().equals(title) && blogPostRepository.existsByTitle(title)) {
             throw new IllegalArgumentException("博客标题已存在: " + title);
         }
         
+        // 使用值对象更新内容
         blogPost.updateContent(title, slug, content, summary, coverImage, category, tags);
         return blogPostRepository.save(blogPost);
     }
Index: backend/interface/src/main/java/com/personal/portfolio/blog/interfaces/exception/RestExceptionHandler.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/backend/interface/src/main/java/com/personal/portfolio/blog/interfaces/exception/RestExceptionHandler.java b/backend/interface/src/main/java/com/personal/portfolio/blog/interfaces/exception/RestExceptionHandler.java
--- a/backend/interface/src/main/java/com/personal/portfolio/blog/interfaces/exception/RestExceptionHandler.java	(revision 0325aaa6a249f79a33f1469fc5f3324b6d54c2f8)
+++ b/backend/interface/src/main/java/com/personal/portfolio/blog/interfaces/exception/RestExceptionHandler.java	(date 1764904477523)
@@ -1,7 +1,7 @@
 package com.personal.portfolio.blog.interfaces.exception;
 
-import com.personal.portfolio.blog.infrastructure.common.response.ResultData;
-import com.personal.portfolio.blog.infrastructure.common.response.ReturnCode;
+import com.personal.portfolio.blog.domain.common.ApiResponse;
+import com.personal.portfolio.blog.domain.common.ResponseCode;
 import lombok.extern.slf4j.Slf4j;
 import org.springframework.http.HttpStatus;
 import org.springframework.web.bind.annotation.ExceptionHandler;
@@ -14,37 +14,37 @@
     /**
      * 默认全局异常处理。
      * @param e the e
-     * @return ResultData
+     * @return ApiResponse
      */
     @ExceptionHandler(Exception.class)
     @ResponseStatus(HttpStatus.INTERNAL_SERVER_ERROR)
-    public ResultData<String> exception(Exception e) {
+    public ApiResponse<String> exception(Exception e) {
         log.error("全局异常信息 ex={}", e.getMessage(), e);
-        return ResultData.fail(ReturnCode.RC500.getCode(),e.getMessage());
+        return ApiResponse.fail(ResponseCode.SYSTEM_ERROR, e.getMessage());
     }
 
     /**
      * 认证异常处理
      * @param e the e
-     * @return ResultData
+     * @return ApiResponse
      */
     @ExceptionHandler(AuthenticationException.class)
     @ResponseStatus(HttpStatus.UNAUTHORIZED)
-    public ResultData<String> handleAuthenticationException(AuthenticationException e) {
+    public ApiResponse<String> handleAuthenticationException(AuthenticationException e) {
         log.warn("认证异常: {}", e.getMessage());
-        return ResultData.fail(ReturnCode.USERNAME_OR_PASSWORD_ERROR.getCode(), e.getMessage());
+        return ApiResponse.fail(ResponseCode.USERNAME_OR_PASSWORD_ERROR, e.getMessage());
     }
 
     /**
      * 参数异常处理
      * @param e the e
-     * @return ResultData
+     * @return ApiResponse
      */
     @ExceptionHandler(IllegalArgumentException.class)
     @ResponseStatus(HttpStatus.BAD_REQUEST)
-    public ResultData<String> handleIllegalArgumentException(IllegalArgumentException e) {
+    public ApiResponse<String> handleIllegalArgumentException(IllegalArgumentException e) {
         log.warn("参数异常: {}", e.getMessage());
-        return ResultData.fail(ReturnCode.RC999.getCode(), e.getMessage());
+        return ApiResponse.fail(ResponseCode.PARAM_ERROR, e.getMessage());
     }
 
 }
Index: backend/interface/src/main/java/com/personal/portfolio/blog/interfaces/controller/AuthController.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/backend/interface/src/main/java/com/personal/portfolio/blog/interfaces/controller/AuthController.java b/backend/interface/src/main/java/com/personal/portfolio/blog/interfaces/controller/AuthController.java
--- a/backend/interface/src/main/java/com/personal/portfolio/blog/interfaces/controller/AuthController.java	(revision 0325aaa6a249f79a33f1469fc5f3324b6d54c2f8)
+++ b/backend/interface/src/main/java/com/personal/portfolio/blog/interfaces/controller/AuthController.java	(date 1764917526762)
@@ -1,13 +1,13 @@
 package com.personal.portfolio.blog.interfaces.controller;
 
 import com.personal.portfolio.blog.application.service.UserRegistrationService;
-import com.personal.portfolio.blog.domain.entity.User;
+import com.personal.portfolio.blog.domain.model.User;
 import com.personal.portfolio.blog.domain.repository.UserRepository;
+import com.personal.portfolio.blog.domain.service.AuthenticationService;
 import com.personal.portfolio.blog.interfaces.dto.request.LoginRequest;
 import com.personal.portfolio.blog.interfaces.dto.request.RegisterRequest;
 import com.personal.portfolio.blog.interfaces.dto.response.*;
 import com.personal.portfolio.blog.interfaces.exception.InvalidCredentialsException;
-import com.personal.portfolio.blog.infrastructure.util.JwtUtil;
 import org.springframework.security.core.Authentication;
 import org.springframework.security.core.annotation.AuthenticationPrincipal;
 import org.springframework.security.core.context.SecurityContextHolder;
@@ -29,12 +29,14 @@
 public class AuthController {
 
     private final UserRegistrationService userRegistrationService;
-    private final JwtUtil jwtUtil;
+    private final AuthenticationService authenticationService;
     private final UserRepository userRepository;
 
-    public AuthController(UserRegistrationService userRegistrationService, JwtUtil jwtUtil, UserRepository userRepository) {
+    public AuthController(UserRegistrationService userRegistrationService, 
+                         AuthenticationService authenticationService,
+                         UserRepository userRepository) {
         this.userRegistrationService = userRegistrationService;
-        this.jwtUtil = jwtUtil;
+        this.authenticationService = authenticationService;
         this.userRepository = userRepository;
     }
 
@@ -227,7 +229,7 @@
         }
         
         // 生成 JWT Token
-        String token = jwtUtil.generateToken(user.getUsername(), user.getId());
+        String token = authenticationService.generateToken(user.getUsername(), user.getId());
         
         LoginResponse response = new LoginResponse();
         response.setToken(token);
Index: backend/application/src/main/java/com/personal/portfolio/blog/application/config/DefaultUserInitializer.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/backend/application/src/main/java/com/personal/portfolio/blog/application/config/DefaultUserInitializer.java b/backend/application/src/main/java/com/personal/portfolio/blog/application/config/DefaultUserInitializer.java
--- a/backend/application/src/main/java/com/personal/portfolio/blog/application/config/DefaultUserInitializer.java	(revision 0325aaa6a249f79a33f1469fc5f3324b6d54c2f8)
+++ b/backend/application/src/main/java/com/personal/portfolio/blog/application/config/DefaultUserInitializer.java	(date 1764917435720)
@@ -1,7 +1,7 @@
 package com.personal.portfolio.blog.application.config;
 
 import com.personal.portfolio.blog.application.service.UserRegistrationService;
-import com.personal.portfolio.blog.domain.entity.User;
+import com.personal.portfolio.blog.domain.model.User;
 import lombok.RequiredArgsConstructor;
 import lombok.extern.slf4j.Slf4j;
 import org.springframework.boot.CommandLineRunner;
Index: backend/interface/src/main/java/com/personal/portfolio/blog/interfaces/controller/BlogPostController.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/backend/interface/src/main/java/com/personal/portfolio/blog/interfaces/controller/BlogPostController.java b/backend/interface/src/main/java/com/personal/portfolio/blog/interfaces/controller/BlogPostController.java
--- a/backend/interface/src/main/java/com/personal/portfolio/blog/interfaces/controller/BlogPostController.java	(revision 0325aaa6a249f79a33f1469fc5f3324b6d54c2f8)
+++ b/backend/interface/src/main/java/com/personal/portfolio/blog/interfaces/controller/BlogPostController.java	(date 1764917556256)
@@ -1,8 +1,10 @@
 package com.personal.portfolio.blog.interfaces.controller;
 
-import com.personal.portfolio.blog.application.service.BlogPostService;
-import com.personal.portfolio.blog.domain.entity.BlogPost;
-import com.personal.portfolio.blog.domain.entity.User;
+import com.personal.portfolio.blog.application.dto.CreateBlogPostCommand;
+import com.personal.portfolio.blog.application.service.BlogPostAppService;
+import com.personal.portfolio.blog.domain.model.BlogPost;
+import com.personal.portfolio.blog.domain.model.User;
+
 import lombok.Getter;
 import lombok.RequiredArgsConstructor;
 import lombok.Setter;
@@ -18,24 +20,33 @@
 @RequiredArgsConstructor
 public class BlogPostController {
     
-    private final BlogPostService blogPostService;
+    private final BlogPostAppService blogPostAppService;
     
     /**
      * 创建博客文章
      */
     @PostMapping
     public BlogPost createBlogPost(@RequestBody CreateBlogPostRequest request) {
-        // 注意：这里需要先获取用户ID，实际项目中可能需要用户认证
-        // 这里暂时简化处理，实际使用时需要根据认证信息获取当前用户ID
-        // 临时使用一个固定的用户ID用于测试
-        Long tempAuthorId = 1L; // 临时用户ID
+        // 用户ID应该从认证信息中获取，这里暂时使用请求中的authorId
+        // 在实际项目中，应该从JWT token或session中获取
+        Long authorId = request.getAuthor() != null ? request.getAuthor().getId() : null;
+        if (authorId == null) {
+            throw new IllegalArgumentException("作者ID不能为空");
+        }
         
-        return blogPostService.createBlogPost(
-            request.getTitle(), 
-            request.getSlug(), 
-            request.getContent(), 
-            tempAuthorId
-        );
+        // 将请求DTO转换为命令对象
+        CreateBlogPostCommand command = new CreateBlogPostCommand();
+        command.setTitle(request.getTitle());
+        command.setSlug(request.getSlug());
+        command.setContent(request.getContent());
+        command.setSummary(request.getSummary());
+        command.setCoverImage(request.getCoverImage());
+        command.setCategory(request.getCategory());
+        command.setTags(request.getTags());
+        command.setAuthorId(authorId);
+        
+        // 使用命令对象调用应用服务
+        return blogPostAppService.createBlogPost(command);
     }
     
     /**
@@ -43,7 +54,7 @@
      */
     @GetMapping
     public List<BlogPost> getAllBlogPosts() {
-        return blogPostService.getAllBlogPosts();
+        return blogPostAppService.getAllBlogPosts();
     }
     
     /**
@@ -51,7 +62,7 @@
      */
     @GetMapping("/published")
     public List<BlogPost> getPublishedBlogPosts() {
-        return blogPostService.getPublishedBlogPosts();
+        return blogPostAppService.getPublishedBlogPosts();
     }
     
     /**
@@ -59,7 +70,7 @@
      */
     @GetMapping("/{id}")
     public BlogPost getBlogPostById(@PathVariable Long id) {
-        return blogPostService.getBlogPostById(id);
+        return blogPostAppService.getBlogPostById(id);
     }
     
     /**
@@ -67,7 +78,7 @@
      */
     @PutMapping("/{id}/publish")
     public BlogPost publishBlogPost(@PathVariable Long id) {
-        return blogPostService.publishBlogPost(id);
+        return blogPostAppService.publishBlogPost(id);
     }
     
     /**
@@ -77,7 +88,7 @@
     public BlogPost updateBlogPost(
             @PathVariable Long id, 
             @RequestBody UpdateBlogPostRequest request) {
-        return blogPostService.updateBlogPost(
+        return blogPostAppService.updateBlogPost(
             id, 
             request.getTitle(), 
             request.getSlug(), 
@@ -94,7 +105,7 @@
      */
     @DeleteMapping("/{id}")
     public void deleteBlogPost(@PathVariable Long id) {
-        blogPostService.deleteBlogPost(id);
+        blogPostAppService.deleteBlogPost(id);
     }
     
     /**
